# This workflow runs Renovate in a self-hosted manner
# It's triggered on a schedule and can also be run manually.
name: Run Renovate

on:
  schedule:
    # Runs "at minute 0 past every hour" (e.g., 1:00, 2:00, 3:00)
    # You can change this, e.g., '0 9 * * 1-5' for 9 AM UTC on weekdays
    - cron: '0 * * * *'
  workflow_dispatch: {} # Allows manual triggering from the Actions tab

jobs:
  renovate:
    runs-on: ubuntu-latest
    # No 'permissions:' block is needed, as the PAT provides its own.

    steps:
      # <-- CHANGED: Added checkout step
      # This is required so Renovate can find your renovate.json
      # and other repository files. This fixes "No repositories found".
      - name: Check out repository
        uses: actions/checkout@v4

      - name: Run Renovate
        # Use the official Renovate GitHub Action
        uses: renovatebot/github-action@v44.0.1
        with:
          # <-- CHANGED: Use a Classic PAT, not GITHUB_TOKEN
          # This ensures Renovate has correct permissions and
          # its PRs will trigger your other CI workflows.
          token: ${{ secrets.RENOVATE_TOKEN }}
          configurationFile: renovate.json